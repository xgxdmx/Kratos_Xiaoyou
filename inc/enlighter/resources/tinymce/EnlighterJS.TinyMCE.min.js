/*! EnlighterJS TinyMCE Plugin 3.5.1 | The MIT License (X11) | https://tinymce.enlighterjs.org */
!function(){"use strict";var e=window.console||{},t=(e.error?e.error.bind(e):null)||function(){};if("undefined"==typeof EnlighterJS_EditorConfig)return void t("No EnlighterJS Config found");if("undefined"==typeof tinymce)return void t("TinyMCE not loaded");var n=tinymce,i=EnlighterJS_EditorConfig,l=function(e,t){var l=function(t){return"PRE"==t.nodeName&&e.dom.hasClass(t,"EnlighterJSRAW")},a=function(t){return"CODE"==t.nodeName&&e.dom.hasClass(t,"EnlighterJSRAW")},o=function(t){return("CODE"==t.nodeName||"PRE"==t.nodeName)&&e.dom.hasClass(t,"EnlighterJSRAW")},r=function(e){var t=[{text:"Default (Global-Settings)",value:null}];return n.each(e,function(e,n){t.push({text:n,value:e.toLowerCase()})}),t},d=r(i.languages),s=r(i.themes),g={open:function(t,n){t.onsubmit=n,e.windowManager.open(t)}},u={show:function(t,n){u.hide();var i=e.dom.create("div",{id:"EnlighterToolbar","data-mce-bogus":"1",contenteditable:!1}),l=e.dom.create("div",{"class":"editicon","data-mce-bogus":"1",contenteditable:!1});i.appendChild(l),e.dom.bind(i,"mousedown",function(e){e.stopPropagation(),n()}),e.getBody().appendChild(i);var a=e.dom.getRect(t);e.dom.setStyles(i,{top:a.y,left:a.x,width:a.w})},hide:function(){var t=e.dom.get("EnlighterToolbar");t&&e.dom.remove(t)}},c=function(e,t){return{title:"Code Settings - EnlighterJS Syntax Highlighter",minWidth:700,body:[{type:"listbox",name:"mode",label:"Mode",values:[{text:"Block-Code",value:"block"},{text:"Inline-Code",value:"inline"}],value:e.mode,style:"direction: ltr; text-align: left"},{type:"listbox",name:"language",label:"Language",values:d,value:e.language,style:"direction: ltr; text-align: left"},{type:"listbox",name:"theme",label:"Theme",values:s,value:e.theme,style:"direction: ltr; text-align: left"},{type:"checkbox",name:"linenums",label:"Show Linenumbers",checked:e.linenumbers,disabled:t},{type:"textbox",name:"highlight",label:"Point out Lines (e.g. 1,2-6,9)",multiline:!1,value:e.highlight,disabled:t,style:"direction: ltr; text-align: left"},{type:"textbox",name:"offset",label:"Linennumber offset (e.g. 5)",multiline:!1,value:e.lineoffset,disabled:t,style:"direction: ltr; text-align: left"},{type:"textbox",name:"group",label:"Codegroup Identifier",multiline:!1,value:e.group,disabled:t,style:"direction: ltr; text-align: left"},{type:"textbox",name:"title",label:"Codegroup Title",multiline:!1,value:e.title,disabled:t,style:"direction: ltr; text-align: left"}]}},h=function(e,t){return{title:"Code Insert - EnlighterJS Syntax Highlighter",layout:"flex",direction:"column",align:"stretch",width:e-50,height:t-150,body:[{type:"listbox",name:"lang",label:"Language",values:d,style:"direction: ltr; text-align: left"},{type:"listbox",name:"mode",label:"Mode",values:[{text:"Block-Code",value:"block"},{text:"Inline-Code",value:"inline"}],value:"block",style:"direction: ltr; text-align: left"},{type:"checkbox",name:"indentation",label:"Left-Align Indentation",checked:i.config.indent>0,disabled:i.config.indent<0},{type:"checkbox",name:"addspaces",label:"Surround with spaces",checked:!1,disabled:!1},{type:"textbox",name:"code",flex:1,multiline:!0,spellcheck:!1,style:"direction: ltr; text-align: left",classes:"monospace",autofocus:!0}]}},f=function(){var t=e.dom.getViewPort(),l=Math.min(t.w,window.innerWidth)||700,a=Math.min(t.h,window.innerHeight)||500;g.open(h(l,a),function(t){var l=t.data.code.replace(/\r\n/gim,"\n"),a="inline"==t.data.mode?"code":"pre";if("block"==t.data.mode&&t.data.indentation){l=l.replace(/^(\t*)/gim,function(e,t,n,l){return new Array(i.config.indent*t.length+1).join(" ")});for(var o=99999,r=l.split("\n"),d=0;d<r.length;d++){var s=r[d];if(s.replace(/\s*/,"").length>0){var g=s.match(/^( *)/gim);if(!g||1!=g.length){o=0;break}o=Math.min(g[0].length,o)}}if(o>0&&o<99999){var u=new RegExp("^( ){"+o+"}","gmi");l=l.replace(u,"")}}l=n.html.Entities.encodeAllRaw(l);var c=t.data.addspaces?"&nbsp;":"";e.insertContent(c+"<"+a+' class="EnlighterJSRAW" data-enlighter-language="'+t.data.lang+'">'+l+"</"+a+">"+c+"<p></p>")})},m=function(t,n){if(o(t)){var l=a(e.selection.getNode())?"inline":"block";if(n.mode!=l){var r=e.dom.create("block"==n.mode?"pre":"code",{"class":"EnlighterJSRAW"});e.dom.replace(r,t,!0),t=r}var d=function(e){n[e]?t.setAttribute("data-enlighter-"+e,n[e]):t.removeAttribute("data-enlighter-"+e)};d("language"),d("theme"),d("highlight"),d("lineoffset"),d("group"),d("title"),n.linenumbers==i.config.linenumbers?t.removeAttribute("data-enlighter-linenumbers"):t.setAttribute("data-enlighter-linenumbers",n.linenumbers?"true":"false")}},b=function(e,t){if(!o(e))return{};var n=e.getAttribute("data-enlighter-linenumbers");return{language:e.getAttribute("data-enlighter-language"),linenumbers:null==n?i.config.linenumbers:"true"==n,highlight:e.getAttribute("data-enlighter-highlight"),lineoffset:e.getAttribute("data-enlighter-lineoffset"),theme:e.getAttribute("data-enlighter-theme"),group:e.getAttribute("data-enlighter-group"),title:e.getAttribute("data-enlighter-title"),mode:t?"inline":"block"}},p=function(){var t=e.selection.getNode(),n=a(t),i=b(t,n);g.open(c(i,n),function(e){m(t,{language:e.data.language,linenumbers:e.data.linenums,highlight:e.data.highlight,lineoffset:e.data.offset,theme:e.data.theme,title:e.data.title,group:e.data.group,mode:e.data.mode})})},v=!1;e.on("PastePreProcess",function(e){v&&(e.stopPropagation(),e.content=e.content.replace(/^\s*<pre(.*?)>([\s\S]+)<\/pre>\s*$/gi,"$2").replace(/\n/g,"<BR/>").replace(/ /g,"&nbsp;").replace(/<span(.*?)>/g,"").replace(/<\/span>/g,""))});var y=null;e.on("NodeChange",function(t){t.stopPropagation();var n=e.selection.getNode();l(n)?(u.show(n,p),v=!0):(u.hide(),v=!1),y&&(o(n)?y.disabled(!1):y.disabled(!0))}),e.addButton("EnlighterInsert",{title:"Code Insert",image:t+"/code-insert-icon.png",onclick:f}),e.addButton("EnlighterEdit",{title:"Code Settings",disabled:!0,image:t+"/code-edit-icon.png",onPostRender:function(){y=this},onclick:p}),i.config.shortcuts===!0&&e.on("init",function(){e.shortcuts.remove("access+x"),e.shortcuts.add("access+x","Enlighter inline code",function(){e.formatter.toggle("enlighterjs_inlinecode")}),e.formatter.register("enlighterjs_inlinecode",{inline:"code",classes:"EnlighterJSRAW",attributes:{"data-enlighter-language":"generic"}})});var x=i.config.indent,C=x>0?new Array(x+1).join(" "):null;i.config.tabIndentation===!0&&null!==C&&(e.on("KeyUp",function(e){v&&(9!==e.keyCode||e.ctrlKey||e.altKey||e.metaKey||e.preventDefault())}),e.on("KeyPress KeyDown",function(t){if(v&&!(9!==t.keyCode||t.ctrlKey||t.altKey||t.metaKey||t.isDefaultPrevented())){t.preventDefault();var n=e.selection.getRng(!0),i=e.selection.getNode(),l=i.textContent,a=l.substring(0,n.startOffset).split("\n").length-1,o=l.substring(0,n.endOffset).split("\n").length-1,r=l.substring(0,n.startOffset).lastIndexOf("\n")+1,d=l.split("\n"),s=0;if(t.shiftKey)for(var g=a;g<=o;g++){var u=d[g].replace(/^(\s*).*?$/,"$1").length,c=Math.min(u,x),h=d[g].substr(c);d[g]=h,s+=h.length+1}else for(var g=a;g<=o;g++){var h=C+d[g];d[g]=h,s+=h.length+1}i.textContent=d.join("\n"),n.setStart(i.firstChild,r),n.setEnd(i.firstChild,r+s-1),e.selection.setRng(n)}}))};n.PluginManager.add("enlighterjs",l)}();